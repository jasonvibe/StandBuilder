# StandBuilder 本地体系数据库使用手册

本文档详细说明了 StandBuilder 项目中本地知识库（体系数据库）的结构、维护方法及使用流程。

## 1. 简介

StandBuilder 采用 **本地文件系统 + 静态 JSON 索引** 的方式构建了一个轻量级、高性能的本地知识库。该数据库旨在存储和管理各类工程/地产行业的标准化体系文件，供前端应用进行检索、预览和生成使用。

## 2. 数据库结构

数据库采用了 **三级目录结构** 进行物理存储，逻辑清晰，便于人工维护。

**根目录路径**: `/Users/jasonmeng/Documents/Ai_Projects/数据库/体系库_Structured`

### 目录层级规范

所有文件必须按照以下层级存放：

```text
体系库_Structured/
├── [行业名称]/              <-- 第一级：所属行业 (如：房地产业, 制造业)
│   ├── [模块名称]/          <-- 第二级：体系模块 (如：工序验收体系, 安全巡检体系)
│   │   ├── [客户名称]/      <-- 第三级：客户/项目名 (如：中建智地, 东威科技)
│   │   │   └── [体系文件].xls  <-- 具体文件
```

**示例**:
*   `房地产业/工序验收体系/中建智地/中建智地-PROD...xls`
*   `制造业/计划管理/东威科技/东威科技-PROD...xls`

## 3. 数据维护与更新

当您需要向数据库中添加、删除或修改文件时，请遵循以下步骤：

### 3.1 添加新文件

1.  **确定分类**: 确认新文件的 **行业**、**模块** 和 **客户**。
2.  **放置文件**:
    *   如果目录已存在，直接将 `.xls` 或 `.xlsx` 文件放入对应的 `[客户名称]` 文件夹中。
    *   如果目录不存在，请手动创建相应的文件夹结构。
    *   **注意**: 文件名建议保留日期后缀（如 `20260130`），以便版本管理。

### 3.2 同步数据库 (关键步骤)

仅仅将文件放入目录是不够的，您必须运行 **数据摄入脚本 (Ingest Script)**，将物理文件转换为前端可读取的 JSON 索引。

**操作步骤**:

1.  打开终端 (Terminal)。
2.  进入项目根目录:
    ```bash
    cd /Users/jasonmeng/Documents/Github/StandBuilder
    ```
3.  运行更新命令:
    ```bash
    node app/scripts/ingest.cjs
    ```

**执行结果**:
*   脚本会自动扫描 `/体系库_Structured` 目录。
*   自动更新 `app/public/db.json` (主索引文件)。
*   在 `app/public/systems/` 下生成每个文件的详细 JSON 数据。
*   将原始 Excel 文件复制到 `app/public/rawFiles/` 供下载使用。

## 4. 前端功能说明

数据同步完成后，刷新 StandBuilder 页面即可看到最新数据。

### 4.1 筛选与搜索
*   **搜索框**: 支持搜索 **体系名称** 或 **客户名称**。
*   **行业筛选**: 顶部新增了行业标签栏（如：房地产业、制造业、建筑服务业），点击可快速过滤。
*   **客户筛选**: 支持按具体客户进行二次过滤。

### 4.2 卡片信息
每个体系卡片上会显示以下元数据：
*   **左上角**: 客户名称
*   **标签**: 所属行业、所属模块
*   **标题**: 体系文件名称
*   **描述**: 包含标准项数量 (Item Count) 和 数据日期。

## 5. 故障排查

**问题: 添加了文件但网页上没显示？**
*   **检查**: 是否运行了 `node app/scripts/ingest.cjs`？
*   **检查**: 文件是否放在了正确的 `行业/模块/客户` 三级目录下？脚本依赖目录结构来提取元数据。
*   **检查**: 文件后缀是否为 `.xls` 或 `.xlsx`。

**问题: 行业或模块显示为 "Uncategorized" 或 "General"？**
*   这通常是因为文件直接放在了根目录或层级不足。请确保文件至少位于三级子目录中。

---
**技术维护**: 本数据库核心逻辑位于 `app/scripts/ingest.cjs`，如需修改分类逻辑或解析规则，请编辑该文件。
